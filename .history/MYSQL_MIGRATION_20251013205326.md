# MigraciÃ³n a MySQL

## âœ… Completado

La aplicaciÃ³n ahora usa **MySQL 8.0** en lugar de SQLite.

### ğŸ³ Docker Compose

**Archivo:** `docker-compose.yml`

```yaml
services:
  mysql:
    image: mysql:8.0
    container_name: quickar-mysql
    ports:
      - "3306:3306"
    environment:
      MYSQL_DATABASE: quickar_db
      MYSQL_USER: quickar_user
      MYSQL_PASSWORD: QuickAR_Pass_2025!
```

### ğŸ“¦ Comandos Docker

**Iniciar MySQL:**
```bash
docker-compose up -d
```

**Ver logs:**
```bash
docker-compose logs -f mysql
```

**Detener MySQL:**
```bash
docker-compose down
```

**Detener y eliminar volÃºmenes (âš ï¸ elimina todos los datos):**
```bash
docker-compose down -v
```

### ğŸ”Œ ConexiÃ³n

**Connection String:**
```
Server=localhost;Port=3306;Database=quickar_db;User=quickar_user;Password=QuickAR_Pass_2025!;CharSet=utf8mb4;
```

**Cliente GUI recomendado:**
- MySQL Workbench
- DBeaver
- TablePlus

### ğŸ” Usuario de Prueba Creado

**Email:** `jenniffermaldonado1992@gmail.com`  
**Password:** `123456`

### ğŸ“Š Tablas Creadas

- âœ… `Users` - Usuarios con autenticaciÃ³n
- âœ… `Experiences` - Experiencias AR (con UserId)
- âœ… `Assets` - Assets 3D/Images de experiencias
- âœ… `AnalyticsEvents` - Eventos de analytics

### ğŸ”„ Migraciones

**Crear nueva migraciÃ³n:**
```bash
cd QrAr.Api
dotnet ef migrations add NombreDeMigracion
```

**Aplicar migraciones:**
```bash
dotnet ef database update
```

**Eliminar Ãºltima migraciÃ³n:**
```bash
dotnet ef migrations remove
```

### ğŸš€ Iniciar AplicaciÃ³n

1. **Levantar MySQL:**
   ```bash
   docker-compose up -d
   ```

2. **Iniciar Backend:**
   ```bash
   cd QrAr.Api
   dotnet watch run
   ```
   Backend: http://localhost:5001

3. **Iniciar Frontend:**
   ```bash
   cd qr-ar-admin
   npm run dev
   ```
   Frontend: http://localhost:3001

### ğŸ“ Cambios Realizados

1. âœ… Reemplazado `Microsoft.EntityFrameworkCore.Sqlite` con `Pomelo.EntityFrameworkCore.MySql 8.0.2`
2. âœ… Actualizado `Program.cs` para usar `UseMySql` en lugar de `UseSqlite`
3. âœ… Configurado connection strings en `appsettings.json` y `appsettings.Development.json`
4. âœ… Eliminadas migraciones antiguas de SQLite
5. âœ… Creada nueva migraciÃ³n inicial para MySQL: `InitialMySqlMigration`
6. âœ… Aplicadas migraciones a la base de datos MySQL
7. âœ… Creado usuario de prueba

### ğŸ” Verificar Base de Datos

**Usando docker exec:**
```bash
docker exec -it quickar-mysql mysql -u quickar_user -p
# Password: QuickAR_Pass_2025!
```

**Comandos SQL Ãºtiles:**
```sql
USE quickar_db;
SHOW TABLES;
SELECT * FROM Users;
SELECT * FROM Experiences;
DESCRIBE Users;
```

### âš™ï¸ ConfiguraciÃ³n de Entity Framework

**Versiones:**
- Entity Framework Core: 8.0.11
- Pomelo MySQL Provider: 8.0.2
- MySQL Server: 8.0

**CaracterÃ­sticas habilitadas:**
- âœ… Retry on failure (5 reintentos)
- âœ… UTF8MB4 charset (soporte completo de emojis y caracteres especiales)
- âœ… Ãndices Ãºnicos en Email y Username
- âœ… Foreign keys con cascade delete
- âœ… RelaciÃ³n User â†’ Experiences (1:N)

### ğŸ¯ Ventajas de MySQL sobre SQLite

1. âœ… **Mejor rendimiento** con mÃºltiples usuarios concurrentes
2. âœ… **Escalabilidad** para producciÃ³n
3. âœ… **Transacciones ACID** completas
4. âœ… **Ãndices optimizados** para consultas rÃ¡pidas
5. âœ… **VolÃºmenes Docker** para persistencia de datos
6. âœ… **FÃ¡cil backup** con `mysqldump`
7. âœ… **ConexiÃ³n remota** desde otras aplicaciones
8. âœ… **Herramientas GUI** profesionales disponibles

### ğŸ”’ Seguridad

**âš ï¸ IMPORTANTE para ProducciÃ³n:**

Cambiar las credenciales en `docker-compose.yml` y `appsettings.json`:
- `MYSQL_ROOT_PASSWORD`
- `MYSQL_PASSWORD`
- Connection string password

**Mejores prÃ¡cticas:**
- Usar variables de entorno en lugar de passwords hardcodeadas
- Configurar SSL/TLS para conexiones
- Restringir acceso por IP si es necesario
- Usar secretos de Docker o Azure Key Vault en producciÃ³n
