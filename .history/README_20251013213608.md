# QuickAR - Plataforma de Realidad Aumentada üöÄ

Una aplicaci√≥n fullstack profesional para crear y compartir experiencias de Realidad Aumentada (AR) mediante c√≥digos QR. Desarrollada con Next.js 15, .NET 9, MySQL 8.0, Docker, y tecnolog√≠as AR de √∫ltima generaci√≥n.

[![TypeScript](https://img.shields.io/badge/TypeScript-007ACC?style=flat&logo=typescript&logoColor=white)](https://www.typescriptlang.org/)
[![Next.js](https://img.shields.io/badge/Next.js-000000?style=flat&logo=next.js&logoColor=white)](https://nextjs.org/)
[![.NET](https://img.shields.io/badge/.NET-512BD4?style=flat&logo=dotnet&logoColor=white)](https://dotnet.microsoft.com/)
[![MySQL](https://img.shields.io/badge/MySQL-4479A1?style=flat&logo=mysql&logoColor=white)](https://www.mysql.com/)
[![Docker](https://img.shields.io/badge/Docker-2496ED?style=flat&logo=docker&logoColor=white)](https://www.docker.com/)
[![React Three Fiber](https://img.shields.io/badge/Three.js-000000?style=flat&logo=three.js&logoColor=white)](https://threejs.org/)

## ‚ú® Caracter√≠sticas Principales

### üéØ **Sistema AR Dual (M√≥vil + Desktop)**

#### **Para M√≥viles (AR Real)**
- ‚úÖ **WebXR** - AR nativo en Chrome para Android
- ‚úÖ **Scene Viewer** - Visor AR de Google (Android)
- ‚úÖ **Quick Look** - AR nativo de Apple (iOS)
- ‚úÖ **Bot√≥n "Ver en AR"** - Activa c√°mara y overlay AR real
- ‚úÖ **model-viewer** - Librer√≠a oficial de Google para AR web

#### **Para Desktop (Visualizaci√≥n 3D)**
- ‚úÖ **React Three Fiber** - Renderizado 3D interactivo de alta calidad
- ‚úÖ **Controles de C√°mara** - Rotar, zoom, y desplazar con mouse
- ‚úÖ **Iluminaci√≥n Realista** - Sombras, reflejos y entorno din√°mico
- ‚úÖ **Grid Infinito** - Navegaci√≥n espacial sin l√≠mites

### üîê **Autenticaci√≥n y Seguridad**
- ‚úÖ **JWT Authentication** - Sistema de tokens seguro
- ‚úÖ **Refresh Tokens** - Sesiones persistentes
- ‚úÖ **Password Hashing** - Bcrypt para seguridad
- ‚úÖ **Protected Routes** - Control de acceso por rol
- ‚úÖ **CORS Configurado** - Seguridad en peticiones cross-origin

### üóÑÔ∏è **Base de Datos MySQL en Docker**
- ‚úÖ **MySQL 8.0** - Base de datos relacional robusta
- ‚úÖ **Docker Compose** - Orquestaci√≥n simple
- ‚úÖ **Persistencia** - Vol√∫menes Docker para datos
- ‚úÖ **Healthchecks** - Monitoreo autom√°tico
- ‚úÖ **UTF8MB4** - Soporte completo de Unicode (emojis)
- ‚úÖ **Entity Framework Core** - ORM con Pomelo MySQL provider

### üì± **Detecci√≥n Inteligente de Dispositivo**
- üîç Detecta autom√°ticamente m√≥vil vs desktop
- üîç Identifica capacidades WebXR
- üîç Reconoce plataforma (iOS/Android)
- üîç Selecciona el mejor visor AR disponible
- üîç Fallback elegante si AR no est√° disponible

### üé® **Tipos de Assets Soportados**

| Tipo | Descripci√≥n | Formatos | AR Nativo |
|------|-------------|----------|-----------|
| **model3d** | Modelos 3D interactivos | `.glb`, `.gltf` | ‚úÖ S√≠ |
| **image** | Im√°genes 2D | `.jpg`, `.png`, `.webp` | ‚ö†Ô∏è Visualizaci√≥n |
| **video** | Videos con controles | `.mp4`, `.webm` | ‚ö†Ô∏è Visualizaci√≥n |
| **message** | Mensajes de texto | Texto plano | ‚ö†Ô∏è Visualizaci√≥n |
| **webcontent** | Enlaces externos | URLs | ‚ùå No |

### üìä **Gesti√≥n de Experiencias**

- ‚úÖ **CRUD Completo** - Crear, leer, actualizar, eliminar experiencias
- ‚úÖ **M√∫ltiples Assets** - Cada experiencia puede tener varios assets
- ‚úÖ **Slugs √önicos** - URLs amigables para compartir
- ‚úÖ **Generaci√≥n de QR** - C√≥digos QR autom√°ticos para cada experiencia
- ‚úÖ **Analytics** - Seguimiento de interacciones de usuarios
- ‚úÖ **Preview en Tiempo Real** - Ve tus experiencias antes de publicar

### üé® **Interfaz de Usuario Moderna**

- üé® **Glass Morphism** - Efectos de cristal y blur modernos
- üé® **Gradientes Din√°micos** - Fondos animados y atractivos
- üé® **Responsive Design** - Optimizado para todos los tama√±os de pantalla
- üé® **Animaciones Suaves** - Transiciones y feedback visual
- üé® **Dark Theme** - Dise√±o oscuro profesional

## üèóÔ∏è Arquitectura del Proyecto

```
QR-App/
‚îú‚îÄ‚îÄ docker-compose.yml                 # üê≥ Configuraci√≥n Docker MySQL
‚îú‚îÄ‚îÄ QrAr.Api/                          # Backend API (.NET 9)
‚îÇ   ‚îú‚îÄ‚îÄ Controllers/                   # Endpoints de API
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ExperiencesController.cs   # CRUD de experiencias
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ FilesController.cs         # Upload de archivos
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AnalyticsController.cs     # Tracking de eventos
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ AuthEndpointGroup.cs       # Autenticaci√≥n JWT
‚îÇ   ‚îú‚îÄ‚îÄ Models/                        # Modelos de dominio
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Experience.cs              # Experiencia AR
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Asset.cs                   # Asset (3D, imagen, etc)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ User.cs                    # Usuario del sistema
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ AnalyticsEvent.cs          # Evento de analytics
‚îÇ   ‚îú‚îÄ‚îÄ Services/                      # L√≥gica de negocio
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ExperienceService.cs       # Servicio de experiencias
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ FileUploadService.cs       # Servicio de uploads
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AnalyticsService.cs        # Servicio de analytics
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ AuthService.cs             # Servicio de autenticaci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ Data/                          # Acceso a datos
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ AppDbContext.cs            # Contexto de EF Core
‚îÇ   ‚îú‚îÄ‚îÄ Migrations/                    # üÜï Migraciones MySQL
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ 20251013234610_InitialMySqlMigration.cs
‚îÇ   ‚îú‚îÄ‚îÄ appsettings.json               # üÜï Configuraci√≥n con MySQL
‚îÇ   ‚îî‚îÄ‚îÄ wwwroot/uploads/               # Archivos subidos
‚îÇ
‚îî‚îÄ‚îÄ qr-ar-admin/                       # Frontend (Next.js 15)
    ‚îú‚îÄ‚îÄ .env.local                     # üÜï Variables de entorno
    ‚îú‚îÄ‚îÄ src/
    ‚îÇ   ‚îú‚îÄ‚îÄ app/                       # App Router de Next.js
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ar/[id]/               # Visor AR unificado
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ experiences/           # Gesti√≥n de experiencias
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ analytics/             # Dashboard de analytics
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ login/                 # Autenticaci√≥n
    ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ register/              # Registro de usuarios
    ‚îÇ   ‚îú‚îÄ‚îÄ components/
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ar/                    # Componentes AR
    ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ UnifiedARViewer.tsx       # üÜï Viewer unificado
    ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ MobileARViewer.tsx        # üÜï AR para m√≥viles
    ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Desktop3DViewer.tsx       # üÜï 3D para desktop
    ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ EnhancedAssetRenderers.tsx # Renderers 3D
    ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ RealisticARViewer.tsx     # Viewer legacy
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ui/                    # Componentes UI
    ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ProtectedRoute.tsx     # Control de acceso
    ‚îÇ   ‚îú‚îÄ‚îÄ contexts/
    ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ AuthContext.tsx        # üÜï Contexto de autenticaci√≥n
    ‚îÇ   ‚îú‚îÄ‚îÄ hooks/
    ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ useARCapabilities.ts   # üÜï Detecci√≥n de capacidades AR
    ‚îÇ   ‚îú‚îÄ‚îÄ lib/
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api/                   # Clientes de API
    ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ experiences.ts     # üÜï API con JWT tokens
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ assetUtils.ts          # üÜï Utilidades de assets
    ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ helpers/               # Funciones auxiliares
    ‚îÇ   ‚îú‚îÄ‚îÄ services/
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api.ts                 # üÜï Servicio API con auth
    ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ authService.ts         # üÜï Servicio de autenticaci√≥n
    ‚îÇ   ‚îú‚îÄ‚îÄ types/
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.ts               # Tipos principales
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.ts                # üÜï Tipos de autenticaci√≥n
    ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ model-viewer.d.ts      # üÜï Tipos de model-viewer
    ‚îÇ   ‚îî‚îÄ‚îÄ styles/
    ‚îÇ       ‚îú‚îÄ‚îÄ globals.css            # Estilos globales
    ‚îÇ       ‚îî‚îÄ‚îÄ model-viewer.css       # üÜï Estilos de AR
    ‚îî‚îÄ‚îÄ public/                        # Archivos est√°ticos
```

## üîß Tecnolog√≠as Utilizadas

### Backend (.NET 9)

| Tecnolog√≠a | Versi√≥n | Prop√≥sito |
|------------|---------|-----------|
| **.NET** | 9.0 | Framework principal |
| **Entity Framework Core** | 8.0.11 | ORM y gesti√≥n de BD |
| **MySQL** | 8.0 | Base de datos relacional üÜï |
| **Pomelo.EntityFrameworkCore.MySql** | 8.0.2 | Proveedor MySQL para EF Core üÜï |
| **Docker** | - | Contenedor MySQL üÜï |
| **Minimal APIs** | - | Endpoints REST ligeros |
| **Swagger/OpenAPI** | - | Documentaci√≥n de API |
| **JWT Authentication** | - | Autenticaci√≥n segura üÜï |

### Frontend (Next.js 15)

| Tecnolog√≠a | Versi√≥n | Prop√≥sito |
|------------|---------|-----------|
| **Next.js** | 15.0 | Framework React |
| **TypeScript** | 5.0+ | Tipado est√°tico |
| **Tailwind CSS** | 3.4 | Estilos utility-first |
| **React Three Fiber** | 8.18 | Renderizado 3D |
| **@react-three/drei** | 9.122 | Helpers para Three.js |
| **Three.js** | 0.164 | Motor 3D |
| **model-viewer** | 3.4+ | AR web de Google |
| **QRCode** | 1.5 | Generaci√≥n de QR |
| **Zustand** | 4.5 | State management |
| **Framer Motion** | 11.18 | Animaciones |

## üöÄ Gu√≠a de Instalaci√≥n

### Prerrequisitos

Aseg√∫rate de tener instalado:

- ‚úÖ **Node.js** 20.0 o superior
- ‚úÖ **.NET SDK** 9.0
- ‚úÖ **Docker y Docker Compose** (para MySQL) üÜï
- ‚úÖ **Git** para control de versiones
- ‚úÖ **PowerShell** 7+ (Windows) o Bash (Linux/Mac)

### 1. Clonar el Repositorio

```powershell
git clone https://github.com/JuanPabloTorres/QuickAR.git
cd QuickAR
```

### 2. Iniciar Base de Datos MySQL üê≥

**¬°NUEVO!** Ahora usamos MySQL en Docker en lugar de SQLite:

```powershell
# Iniciar contenedor MySQL
docker-compose up -d

# Verificar que MySQL est√° corriendo
docker ps

# Ver logs si hay problemas
docker-compose logs mysql
```

**Configuraci√≥n de MySQL:**
- **Puerto:** 3306
- **Base de datos:** quickar_db
- **Usuario:** quickar_user
- **Contrase√±a:** QuickAR_Pass_2025!

El contenedor tiene:
- ‚úÖ Healthcheck autom√°tico
- ‚úÖ Volumen persistente (mysql_data)
- ‚úÖ Red custom (quickar-network)

### 3. Configurar Backend (.NET API)

```powershell
# Navegar a la carpeta del API
cd QrAr.Api

# Restaurar dependencias
dotnet restore

# Aplicar migraciones de base de datos
dotnet ef database update

# Ejecutar el servidor (modo desarrollo)
dotnet run

# O usar watch para auto-reload
dotnet watch run
```

**‚ö†Ô∏è IMPORTANTE:** Aseg√∫rate de que MySQL est√© corriendo antes de ejecutar el backend:

```powershell
# Verificar estado de MySQL
docker ps | findstr mysql

# Si no est√° corriendo, iniciarlo
docker-compose up -d
```

El API estar√° disponible en:

- üåê HTTP: `http://localhost:5001`
- üîí HTTPS: `https://localhost:5002`
- üìö Swagger: `https://localhost:5002/swagger`

### 3. Configurar Frontend (Next.js)

```powershell
# Navegar a la carpeta del frontend
cd qr-ar-admin

# Instalar dependencias
npm install

# Ejecutar en desarrollo
npm run dev

# O para desarrollo con HTTPS
npm run dev:https
```

El frontend estar√° disponible en:
- üåê HTTP: `http://localhost:3001`
- üîí HTTPS: `https://localhost:3000` (con dev:https)

### 4. Configuraci√≥n de Variables de Entorno

#### Backend (`QrAr.Api/appsettings.json`) üÜï

**¬°ACTUALIZADO!** Ahora usa MySQL en lugar de SQLite:

```json
{
  "ConnectionStrings": {
    "DefaultConnection": "Server=localhost;Port=3306;Database=quickar_db;User=quickar_user;Password=QuickAR_Pass_2025!;CharSet=utf8mb4;"
  },
  "Jwt": {
    "Key": "tu-clave-secreta-super-segura-de-al-menos-32-caracteres",
    "Issuer": "QuickAR",
    "Audience": "QuickAR-Users",
    "ExpirationMinutes": 60
  },
  "AllowedOrigins": [
    "http://localhost:3001",
    "https://localhost:3001",
    "https://localhost:3000"
  ]
}
```

**Notas importantes:**
- ‚úÖ La cadena de conexi√≥n apunta a MySQL en Docker (puerto 3306)
- ‚úÖ JWT Key debe ser una cadena segura de al menos 32 caracteres
- ‚úÖ Los or√≠genes permitidos incluyen ambos protocolos HTTP/HTTPS

#### Frontend (`qr-ar-admin/.env.local`) üÜï

**¬°NUEVO!** Crea este archivo para configuraci√≥n del frontend:

```env
# URL base del API backend
NEXT_PUBLIC_API_BASE_URL=https://localhost:5002
API_INTERNAL_BASE_URL=https://localhost:5002

# Puerto del frontend (3001 por defecto)
# El frontend corre en https://localhost:3001
```

**Notas importantes:**
- ‚úÖ `NEXT_PUBLIC_API_BASE_URL` se expone al navegador (para llamadas desde cliente)
- ‚úÖ `API_INTERNAL_BASE_URL` se usa en servidor Next.js (SSR)
- ‚úÖ Los tokens JWT se guardan en localStorage con la clave `"auth_token"`
    "https://localhost:3000"
  ]
}
```

#### Frontend (`.env.local`)

```env
# API Backend URL
NEXT_PUBLIC_API_BASE_URL=http://localhost:5001

# Para producci√≥n
# NEXT_PUBLIC_API_BASE_URL=https://tu-api.com
```

## üì± Gu√≠a de Uso

### Crear una Experiencia AR

1. **Acceder al Panel Admin**
   - Navega a `http://localhost:3001`
   - Inicia sesi√≥n (o reg√≠strate)

2. **Crear Nueva Experiencia**
   - Click en "Nueva Experiencia"
   - Completa el formulario:
     - **T√≠tulo**: Nombre descriptivo
     - **Slug**: URL amigable (auto-generado)
     - **Descripci√≥n**: Descripci√≥n opcional

3. **Agregar Assets**
   - Click en "Agregar Asset"
   - Selecciona el tipo:
     - üì¶ **Modelo 3D**: Sube archivo `.glb` o `.gltf`
     - üñºÔ∏è **Imagen**: Sube `.jpg`, `.png`, `.webp`
     - üé• **Video**: Sube `.mp4`, `.webm`
     - üí¨ **Mensaje**: Escribe texto
     - üåê **Web Content**: Ingresa URL
   - Completa los campos y guarda

4. **Generar C√≥digo QR**
   - El sistema genera autom√°ticamente un QR
   - Descarga o comparte el enlace

5. **Ver en AR**
   - Escanea el QR con tu m√≥vil
   - O accede directamente a la URL
   - El sistema detectar√° autom√°ticamente tu dispositivo
   - **M√≥vil**: Ver√°s bot√≥n "Ver en AR" para modelos 3D
   - **Desktop**: Ver√°s visualizaci√≥n 3D interactiva

### Probar AR en Diferentes Dispositivos

#### En Android:
1. Abre Chrome en tu Android
2. Escanea el QR o accede a la URL
3. Para modelos 3D, ver√°s el bot√≥n "Ver en AR"
4. Click para activar la c√°mara y ver en tu espacio

#### En iOS:

1. Abre Safari en tu iPhone/iPad
2. Escanea el QR o accede a la URL
3. Para modelos 3D, aparecer√° el √≠cono de AR
4. Tap para usar Quick Look AR nativo

#### En Desktop:

1. Abre cualquier navegador moderno
2. Accede a la URL de la experiencia
3. Usa mouse para interactuar:
   - **Click izquierdo + arrastrar**: Rotar
   - **Scroll**: Zoom
   - **Click derecho + arrastrar**: Desplazar
   - **Click en objeto**: Seleccionar

## üê≥ Comandos Docker √ötiles

### Gesti√≥n del Contenedor MySQL

```powershell
# Iniciar MySQL
docker-compose up -d

# Ver estado de contenedores
docker ps

# Ver logs en tiempo real
docker-compose logs -f mysql

# Detener MySQL
docker-compose down

# Detener y eliminar vol√∫menes (‚ö†Ô∏è borra todos los datos)
docker-compose down -v

# Reiniciar contenedor
docker-compose restart mysql
```

### Acceso a MySQL

```powershell
# Conectarse a MySQL desde la terminal
docker exec -it quickar-mysql mysql -u quickar_user -p
# Password: QuickAR_Pass_2025!

# Ejecutar comandos SQL directamente
docker exec quickar-mysql mysql -u quickar_user -pQuickAR_Pass_2025! -e "SHOW DATABASES;"

# Backup de la base de datos
docker exec quickar-mysql mysqldump -u quickar_user -pQuickAR_Pass_2025! quickar_db > backup.sql

# Restaurar backup
docker exec -i quickar-mysql mysql -u quickar_user -pQuickAR_Pass_2025! quickar_db < backup.sql
```

## üîê Autenticaci√≥n y Seguridad

### Flujo de Autenticaci√≥n JWT

1. **Registro de Usuario**: `POST /api/v1/auth/register`
   - Crea usuario con email y contrase√±a
   - Contrase√±a hasheada con BCrypt

2. **Login**: `POST /api/v1/auth/login`
   - Retorna JWT token v√°lido por 60 minutos
   - Token incluye: userId, email, roles

3. **Uso del Token**:
   - Frontend guarda token en `localStorage` con clave `"auth_token"`
   - Incluye en header: `Authorization: Bearer {token}`
   - API valida token en cada request protegido

4. **Protecci√≥n de Rutas**:
   - Backend: Usa `[Authorize]` attribute
   - Frontend: Usa `ProtectedRoute` component

### Endpoints de Autenticaci√≥n

```typescript
// Registro
POST /api/v1/auth/register
{
  "email": "usuario@example.com",
  "password": "Password123!",
  "fullName": "Usuario Test"
}

// Login
POST /api/v1/auth/login
{
  "email": "usuario@example.com",
  "password": "Password123!"
}

// Respuesta
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "userId": "550e8400-e29b-41d4-a716-446655440000",
  "email": "usuario@example.com",
  "expiresAt": "2024-01-15T12:00:00Z"
}
```

### Uso en Frontend

```typescript
// authService guarda el token
localStorage.setItem("auth_token", token);

// experiences.ts y api.ts lo leen
const token = localStorage.getItem("auth_token");

// Lo incluyen en headers
headers: {
  'Authorization': `Bearer ${token}`,
  'Content-Type': 'application/json'
}
```

## üéØ Endpoints de API

### Experiencias

```http
GET    /api/v1/experiences              # Listar todas (requiere auth üîí)
GET    /api/v1/experiences/{id}         # Obtener por ID
GET    /api/v1/experiences/slug/{slug}  # Obtener por slug
POST   /api/v1/experiences              # Crear nueva (requiere auth üîí)
PUT    /api/v1/experiences/{id}         # Actualizar (requiere auth üîí)
DELETE /api/v1/experiences/{id}         # Eliminar (requiere auth üîí)
PATCH  /api/v1/experiences/{id}/toggle-active  # Activar/Desactivar (requiere auth üîí)
```

### Assets de Archivo

```http
POST   /api/files/upload                # Subir archivo
GET    /uploads/{filename}              # Descargar archivo
```

### Analytics

```http
POST   /api/analytics/track             # Registrar evento
GET    /api/analytics/experience/{id}   # Estad√≠sticas por experiencia
```

### Autenticaci√≥n

```http
POST   /api/auth/register               # Registrar usuario
POST   /api/auth/login                  # Iniciar sesi√≥n
POST   /api/auth/refresh                # Refrescar token
```

## üé® Arquitectura AR Explicada

### Flujo de Detecci√≥n y Renderizado

```
Usuario accede a /ar/[id]
         ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  UnifiedARViewer       ‚îÇ  ‚Üê Componente principal
‚îÇ  - Detecta dispositivo ‚îÇ
‚îÇ  - Verifica capacidades‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚Üì
    ¬øM√≥vil o AR disponible?
         ‚Üì
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ         ‚îÇ
   S√ç        NO
    ‚îÇ         ‚îÇ
    ‚Üì         ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Mobile  ‚îÇ ‚îÇ Desktop      ‚îÇ
‚îÇ AR      ‚îÇ ‚îÇ 3D Viewer    ‚îÇ
‚îÇ Viewer  ‚îÇ ‚îÇ              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
    ‚îÇ              ‚îÇ
    ‚Üì              ‚Üì
model-viewer   React Three
WebXR/Scene       Fiber
Viewer/Quick      + drei
Look
```

### Componentes AR Clave

#### 1. **UnifiedARViewer** üéØ
- Punto de entrada principal
- Detecta capacidades del dispositivo
- Rutea al viewer apropiado
- Maneja estados de carga y error

#### 2. **MobileARViewer** üì±
- Usa `<model-viewer>` de Google
- Soporta WebXR, Scene Viewer, Quick Look
- Bot√≥n "Ver en AR" prominente
- Renderiza todos los tipos de assets

#### 3. **Desktop3DViewer** üñ•Ô∏è
- Usa React Three Fiber
- Escena 3D interactiva completa
- Controles de c√°mara orbital
- Iluminaci√≥n y sombras realistas

#### 4. **useARCapabilities** üîç
- Hook personalizado
- Detecta tipo de dispositivo
- Verifica soporte WebXR
- Identifica plataforma (iOS/Android)
- Retorna capacidades disponibles

## üß™ Testing y QA

### Checklist de Pruebas

#### Desktop
- [ ] Visualizaci√≥n 3D funciona en Chrome
- [ ] Visualizaci√≥n 3D funciona en Firefox
- [ ] Visualizaci√≥n 3D funciona en Safari
- [ ] Controles de c√°mara responsive
- [ ] Assets se cargan correctamente
- [ ] Navegaci√≥n entre assets fluida

#### Android
- [ ] Chrome: WebXR funciona
- [ ] Chrome: Scene Viewer funciona
- [ ] Firefox: Visualizaci√≥n funciona
- [ ] Bot√≥n AR visible y funcional
- [ ] C√°mara se activa correctamente

#### iOS
- [ ] Safari: Quick Look funciona
- [ ] Chrome: Visualizaci√≥n funciona
- [ ] Bot√≥n AR visible
- [ ] Assets se descargan correctamente

### Comandos de Testing

```powershell
# Frontend - Type checking
cd qr-ar-admin
npm run type-check

# Frontend - Linting
npm run lint

# Backend - Unit tests
cd QrAr.Api
dotnet test

# Backend - Build
dotnet build
```

## üìà Roadmap

### Versi√≥n 1.1 (Q4 2025)
- [ ] Editor AR en tiempo real
- [ ] Plantillas de experiencias predefinidas
- [ ] Exportaci√≥n de experiencias
- [ ] Colaboraci√≥n multi-usuario

### Versi√≥n 1.2 (Q1 2026)
- [ ] Marketplace de assets 3D
- [ ] Animaciones en modelos 3D
- [ ] Audio espacial
- [ ] Geolocalizaci√≥n AR

### Versi√≥n 2.0 (Q2 2026)
- [ ] AR Cloud (persistencia)
- [ ] Multiplayer AR
- [ ] IA generativa de assets
- [ ] WebGPU para mejor rendimiento

## üêõ Soluci√≥n de Problemas

### Error: "Unable to connect to any of the specified MySQL hosts" üÜï

**Causa**: MySQL no est√° corriendo o no est√° accesible
**Soluci√≥n**:

```powershell
# 1. Verificar que Docker est√° corriendo
docker ps

# 2. Si no aparece quickar-mysql, iniciarlo
docker-compose up -d

# 3. Verificar logs de MySQL
docker-compose logs mysql

# 4. Verificar healthcheck
docker inspect quickar-mysql | findstr "Health"

# 5. Reiniciar contenedor si es necesario
docker-compose restart mysql
```

### Error: "Authentication to host 'localhost' failed" üÜï

**Causa**: Credenciales incorrectas en connection string
**Soluci√≥n**:

- Verifica que `appsettings.json` tiene las credenciales correctas:
  - User: `quickar_user`
  - Password: `QuickAR_Pass_2025!`
  - Database: `quickar_db`
  - Port: `3306`

```json
"DefaultConnection": "Server=localhost;Port=3306;Database=quickar_db;User=quickar_user;Password=QuickAR_Pass_2025!;CharSet=utf8mb4;"
```

### Error: "401 Unauthorized" en llamadas a API üÜï

**Causa**: Token JWT no se est√° enviando correctamente
**Soluci√≥n**:

```typescript
// 1. Verificar que el token se guard√≥ en localStorage
console.log(localStorage.getItem("auth_token"));

// 2. Verificar que se incluye en headers (experiences.ts y api.ts)
const token = localStorage.getItem("auth_token");
headers: {
  'Authorization': `Bearer ${token}`,
  'Content-Type': 'application/json'
}

// 3. Verificar que el token no expir√≥
// Los tokens JWT expiran despu√©s de 60 minutos por defecto
// Si expir√≥, hacer login nuevamente
```

### Error: "Cannot find module '@google/model-viewer'"

**Causa**: Dependencias de frontend no instaladas
**Soluci√≥n**:

```powershell
cd qr-ar-admin
npm install
# O si persiste:
rm -rf node_modules package-lock.json
npm install
```

### Error: "Port 3306 already in use" üÜï

**Causa**: Otro servicio MySQL ya est√° usando el puerto 3306
**Soluci√≥n**:

```powershell
# Opci√≥n 1: Detener otro MySQL
# En Windows:
Stop-Service MySQL80  # O el nombre de tu servicio

# Opci√≥n 2: Cambiar puerto en docker-compose.yml
# Editar docker-compose.yml:
ports:
  - "3307:3306"  # Usa 3307 en lugar de 3306

# Y actualizar appsettings.json:
"Server=localhost;Port=3307;Database=quickar_db;..."
```

### Error: "AR no disponible"

**Causa**: Dispositivo no soporta AR o conexi√≥n no segura
**Soluci√≥n**:

- Verifica que est√°s usando HTTPS o localhost
- Aseg√∫rate que el dispositivo soporta WebXR
- En Android, actualiza Chrome a √∫ltima versi√≥n
- En iOS, usa Safari (no Chrome)

### Error: "Modelo 3D no carga"
**Causa**: Archivo corrupto, formato no soportado, o problema de CORS
**Soluci√≥n**:
- Verifica que el archivo es `.glb` o `.gltf` v√°lido
- Confirma que el archivo no excede 50MB
- Revisa la consola del navegador para errores CORS
- Aseg√∫rate que el backend est√° corriendo

### Error: "No se puede subir archivo"
**Causa**: Archivo muy grande o tipo no permitido
**Soluci√≥n**:
- M√°ximo 50MB por archivo
- Solo se permiten: `.glb`, `.gltf`, `.jpg`, `.png`, `.webp`, `.mp4`, `.webm`
- Verifica permisos de escritura en `wwwroot/uploads/`

### Performance: "Modelo 3D lento"
**Causa**: Modelo muy complejo o dispositivo limitado
**Soluci√≥n**:
- Optimiza el modelo (reduce pol√≠gonos)
- Usa texturas comprimidas
- Considera usar LOD (Level of Detail)
- Limita a ~100K tri√°ngulos para m√≥viles

## üîí Seguridad

### Autenticaci√≥n
- JWT (JSON Web Tokens) con expiraci√≥n
- Refresh tokens para sesiones largas
- Passwords hasheados con bcrypt
- Protecci√≥n CSRF en formularios

### CORS
- Configurado solo para or√≠genes permitidos
- Headers de seguridad apropiados
- Rate limiting en endpoints sensibles

### File Upload
- Validaci√≥n de tipo MIME
- L√≠mite de tama√±o de archivo
- Nombres de archivo sanitizados
- Almacenamiento seguro fuera del webroot p√∫blico

## üìö Documentaci√≥n Adicional

### Estructura de Datos

#### Experience
```typescript
interface Experience {
  id: string;              // GUID √∫nico
  title: string;           // T√≠tulo de la experiencia
  slug: string;            // URL-friendly identifier
  description?: string;    // Descripci√≥n opcional
  isActive: boolean;       // Estado activo/inactivo
  assets: Asset[];         // Assets asociados
  createdAt: Date;         // Fecha de creaci√≥n
  updatedAt: Date;         // √öltima actualizaci√≥n
  userId?: string;         // Propietario
}
```

#### Asset
```typescript
interface Asset {
  id: string;              // GUID √∫nico
  name: string;            // Nombre del asset
  assetType: AssetType;    // Tipo de asset
  assetUrl?: string;       // URL del archivo
  mimeType?: string;       // Tipo MIME
  fileSizeBytes?: number;  // Tama√±o en bytes
  assetContent?: string;   // Contenido (para messages)
}

type AssetType = 
  | "model3d"     // Modelos 3D (.glb, .gltf)
  | "image"       // Im√°genes (.jpg, .png, .webp)
  | "video"       // Videos (.mp4, .webm)
  | "message"     // Texto plano
  | "webcontent"; // URLs externas
```

### Comandos √ötiles

#### Backend

```powershell
# Crear nueva migraci√≥n
dotnet ef migrations add NombreMigracion

# Aplicar migraciones
dotnet ef database update

# Revertir migraci√≥n
dotnet ef database update MigracionAnterior

# Eliminar √∫ltima migraci√≥n
dotnet ef migrations remove

# Ver migraciones aplicadas
dotnet ef migrations list

# Crear build de producci√≥n
dotnet publish -c Release -o ./publish

# Limpiar build
dotnet clean
```

#### Frontend

```powershell
# Desarrollo
npm run dev          # Puerto 3001 HTTP
npm run dev:https    # Puerto 3000 HTTPS
npm run dev:mobile   # 0.0.0.0:3000 (acceso red local)

# Build
npm run build        # Crear build de producci√≥n
npm run start        # Ejecutar build de producci√≥n

# Calidad de c√≥digo
npm run lint         # ESLint
npm run type-check   # TypeScript checking

# Limpieza
rm -rf .next         # Eliminar build
rm -rf node_modules  # Eliminar dependencias
npm install          # Reinstalar dependencias
```

## ü§ù Contribuir

¬°Las contribuciones son bienvenidas! Por favor sigue estos pasos:

### 1. Fork y Clone
```bash
# Fork el repositorio en GitHub
git clone https://github.com/tu-usuario/QuickAR.git
cd QuickAR
```

### 2. Crear Rama
```bash
# Crear rama para tu feature
git checkout -b feature/mi-nueva-caracteristica

# O para un bugfix
git checkout -b fix/arreglar-bug
```

### 3. Desarrollar
- Sigue las convenciones de c√≥digo existentes
- Escribe c√≥digo TypeScript tipado
- Agrega comentarios JSDoc donde sea necesario
- Prueba en m√∫ltiples navegadores/dispositivos

### 4. Commit
```bash
# Commits descriptivos siguiendo conventional commits
git commit -m "feat: agregar nueva caracter√≠stica X"
git commit -m "fix: corregir bug en componente Y"
git commit -m "docs: actualizar README"
```

### 5. Push y Pull Request
```bash
# Push a tu fork
git push origin feature/mi-nueva-caracteristica

# Crear Pull Request en GitHub
# Describe los cambios claramente
# Incluye capturas de pantalla si aplica
```

### Gu√≠as de Estilo

#### TypeScript
- Usa `interface` para objetos, `type` para uniones
- Nombra interfaces con prefijo `I` solo si es necesario
- Prefiere `const` sobre `let`, evita `var`
- Usa arrow functions para callbacks

#### React
- Componentes funcionales con hooks
- Props destructuring en la firma
- `memo()` para componentes pesados
- Custom hooks con prefijo `use`

#### CSS
- Usa Tailwind classes cuando sea posible
- Evita estilos inline
- Agrupa clases relacionadas
- Usa variables CSS para temas

## üìú Licencia

Este proyecto est√° licenciado bajo la **MIT License**.

```
MIT License

Copyright (c) 2025 QuickAR

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
```

## üìû Contacto y Soporte

### Reportar Problemas
- üêõ **Bugs**: [Abrir Issue en GitHub](https://github.com/JuanPabloTorres/QuickAR/issues/new?template=bug_report.md)
- üí° **Feature Request**: [Sugerir Feature](https://github.com/JuanPabloTorres/QuickAR/issues/new?template=feature_request.md)
- üìñ **Documentaci√≥n**: [Mejorar Docs](https://github.com/JuanPabloTorres/QuickAR/issues/new?template=documentation.md)

### Comunidad
- üí¨ **Discussions**: [GitHub Discussions](https://github.com/JuanPabloTorres/QuickAR/discussions)
- üìß **Email**: support@quickar.dev
- üê¶ **Twitter**: [@QuickARDev](https://twitter.com/QuickARDev)

## üôè Agradecimientos

Este proyecto fue posible gracias a:

- **[Google Model Viewer](https://modelviewer.dev/)** - Por la incre√≠ble librer√≠a AR
- **[React Three Fiber](https://docs.pmnd.rs/react-three-fiber)** - Por el wrapper de Three.js
- **[drei](https://github.com/pmndrs/drei)** - Por los helpers de Three.js
- **[Next.js Team](https://nextjs.org/)** - Por el mejor framework de React
- **[.NET Team](https://dotnet.microsoft.com/)** - Por la plataforma robusta
- **Comunidad Open Source** - Por las contribuciones y feedback

## üåü Showcase

¬øCreaste algo genial con QuickAR? ¬°Comp√°rtelo!

Env√≠a un PR agregando tu proyecto aqu√≠ o menciona [@QuickARDev](https://twitter.com/QuickARDev) en Twitter.

### Ejemplos de Uso
- üèõÔ∏è **Museos**: Tours virtuales AR
- üè¢ **Real Estate**: Visualizaci√≥n de propiedades
- üéì **Educaci√≥n**: Modelos anat√≥micos 3D
- üõçÔ∏è **E-commerce**: Preview de productos
- üé® **Arte**: Galer√≠as virtuales
- üè≠ **Industria**: Manuales de mantenimiento

---

<div align="center">

**Hecho con ‚ù§Ô∏è por el equipo de QuickAR**

‚≠ê Si te gusta este proyecto, ¬°dale una estrella en GitHub! ‚≠ê

[‚¨Ü Volver arriba](#quickar---plataforma-de-realidad-aumentada-)

</div>
