# QuickAR - Plataforma de Realidad Aumentada 🚀

Una aplicación fullstack profesional para crear y compartir experiencias de Realidad Aumentada (AR) mediante códigos QR. Desarrollada con Next.js 15, .NET 9, MySQL 8.0, Docker, y tecnologías AR de última generación.

[![TypeScript](https://img.shields.io/badge/TypeScript-007ACC?style=flat&logo=typescript&logoColor=white)](https://www.typescriptlang.org/)
[![Next.js](https://img.shields.io/badge/Next.js-000000?style=flat&logo=next.js&logoColor=white)](https://nextjs.org/)
[![.NET](https://img.shields.io/badge/.NET-512BD4?style=flat&logo=dotnet&logoColor=white)](https://dotnet.microsoft.com/)
[![MySQL](https://img.shields.io/badge/MySQL-4479A1?style=flat&logo=mysql&logoColor=white)](https://www.mysql.com/)
[![Docker](https://img.shields.io/badge/Docker-2496ED?style=flat&logo=docker&logoColor=white)](https://www.docker.com/)
[![React Three Fiber](https://img.shields.io/badge/Three.js-000000?style=flat&logo=three.js&logoColor=white)](https://threejs.org/)

## ✨ Características Principales

### 🎯 **Sistema AR Dual (Móvil + Desktop)**

#### **Para Móviles (AR Real)**
- ✅ **WebXR** - AR nativo en Chrome para Android
- ✅ **Scene Viewer** - Visor AR de Google (Android)
- ✅ **Quick Look** - AR nativo de Apple (iOS)
- ✅ **Botón "Ver en AR"** - Activa cámara y overlay AR real
- ✅ **model-viewer** - Librería oficial de Google para AR web

#### **Para Desktop (Visualización 3D)**
- ✅ **React Three Fiber** - Renderizado 3D interactivo de alta calidad
- ✅ **Controles de Cámara** - Rotar, zoom, y desplazar con mouse
- ✅ **Iluminación Realista** - Sombras, reflejos y entorno dinámico
- ✅ **Grid Infinito** - Navegación espacial sin límites

### 🔐 **Autenticación y Seguridad**
- ✅ **JWT Authentication** - Sistema de tokens seguro
- ✅ **Refresh Tokens** - Sesiones persistentes
- ✅ **Password Hashing** - Bcrypt para seguridad
- ✅ **Protected Routes** - Control de acceso por rol
- ✅ **CORS Configurado** - Seguridad en peticiones cross-origin

### 🗄️ **Base de Datos MySQL en Docker**
- ✅ **MySQL 8.0** - Base de datos relacional robusta
- ✅ **Docker Compose** - Orquestación simple
- ✅ **Persistencia** - Volúmenes Docker para datos
- ✅ **Healthchecks** - Monitoreo automático
- ✅ **UTF8MB4** - Soporte completo de Unicode (emojis)
- ✅ **Entity Framework Core** - ORM con Pomelo MySQL provider

### 📱 **Detección Inteligente de Dispositivo**
- 🔍 Detecta automáticamente móvil vs desktop
- 🔍 Identifica capacidades WebXR
- 🔍 Reconoce plataforma (iOS/Android)
- 🔍 Selecciona el mejor visor AR disponible
- 🔍 Fallback elegante si AR no está disponible

### 🎨 **Tipos de Assets Soportados**

| Tipo | Descripción | Formatos | AR Nativo |
|------|-------------|----------|-----------|
| **model3d** | Modelos 3D interactivos | `.glb`, `.gltf` | ✅ Sí |
| **image** | Imágenes 2D | `.jpg`, `.png`, `.webp` | ⚠️ Visualización |
| **video** | Videos con controles | `.mp4`, `.webm` | ⚠️ Visualización |
| **message** | Mensajes de texto | Texto plano | ⚠️ Visualización |
| **webcontent** | Enlaces externos | URLs | ❌ No |

### 📊 **Gestión de Experiencias**

- ✅ **CRUD Completo** - Crear, leer, actualizar, eliminar experiencias
- ✅ **Múltiples Assets** - Cada experiencia puede tener varios assets
- ✅ **Slugs Únicos** - URLs amigables para compartir
- ✅ **Generación de QR** - Códigos QR automáticos para cada experiencia
- ✅ **Analytics** - Seguimiento de interacciones de usuarios
- ✅ **Preview en Tiempo Real** - Ve tus experiencias antes de publicar

### 🎨 **Interfaz de Usuario Moderna**

- 🎨 **Glass Morphism** - Efectos de cristal y blur modernos
- 🎨 **Gradientes Dinámicos** - Fondos animados y atractivos
- 🎨 **Responsive Design** - Optimizado para todos los tamaños de pantalla
- 🎨 **Animaciones Suaves** - Transiciones y feedback visual
- 🎨 **Dark Theme** - Diseño oscuro profesional

## 🏗️ Arquitectura del Proyecto

```
QR-App/
├── docker-compose.yml                 # 🐳 Configuración Docker MySQL
├── QrAr.Api/                          # Backend API (.NET 9)
│   ├── Controllers/                   # Endpoints de API
│   │   ├── ExperiencesController.cs   # CRUD de experiencias
│   │   ├── FilesController.cs         # Upload de archivos
│   │   ├── AnalyticsController.cs     # Tracking de eventos
│   │   └── AuthEndpointGroup.cs       # Autenticación JWT
│   ├── Models/                        # Modelos de dominio
│   │   ├── Experience.cs              # Experiencia AR
│   │   ├── Asset.cs                   # Asset (3D, imagen, etc)
│   │   ├── User.cs                    # Usuario del sistema
│   │   └── AnalyticsEvent.cs          # Evento de analytics
│   ├── Services/                      # Lógica de negocio
│   │   ├── ExperienceService.cs       # Servicio de experiencias
│   │   ├── FileUploadService.cs       # Servicio de uploads
│   │   ├── AnalyticsService.cs        # Servicio de analytics
│   │   └── AuthService.cs             # Servicio de autenticación
│   ├── Data/                          # Acceso a datos
│   │   └── AppDbContext.cs            # Contexto de EF Core
│   ├── Migrations/                    # 🆕 Migraciones MySQL
│   │   └── 20251013234610_InitialMySqlMigration.cs
│   ├── appsettings.json               # 🆕 Configuración con MySQL
│   └── wwwroot/uploads/               # Archivos subidos
│
└── qr-ar-admin/                       # Frontend (Next.js 15)
    ├── .env.local                     # 🆕 Variables de entorno
    ├── src/
    │   ├── app/                       # App Router de Next.js
    │   │   ├── ar/[id]/               # Visor AR unificado
    │   │   ├── experiences/           # Gestión de experiencias
    │   │   ├── analytics/             # Dashboard de analytics
    │   │   ├── login/                 # Autenticación
    │   │   └── register/              # Registro de usuarios
    │   ├── components/
    │   │   ├── ar/                    # Componentes AR
    │   │   │   ├── UnifiedARViewer.tsx       # 🆕 Viewer unificado
    │   │   │   ├── MobileARViewer.tsx        # 🆕 AR para móviles
    │   │   │   ├── Desktop3DViewer.tsx       # 🆕 3D para desktop
    │   │   │   ├── EnhancedAssetRenderers.tsx # Renderers 3D
    │   │   │   └── RealisticARViewer.tsx     # Viewer legacy
    │   │   ├── ui/                    # Componentes UI
    │   │   └── ProtectedRoute.tsx     # Control de acceso
    │   ├── contexts/
    │   │   └── AuthContext.tsx        # 🆕 Contexto de autenticación
    │   ├── hooks/
    │   │   └── useARCapabilities.ts   # 🆕 Detección de capacidades AR
    │   ├── lib/
    │   │   ├── api/                   # Clientes de API
    │   │   │   └── experiences.ts     # 🆕 API con JWT tokens
    │   │   ├── assetUtils.ts          # 🆕 Utilidades de assets
    │   │   └── helpers/               # Funciones auxiliares
    │   ├── services/
    │   │   ├── api.ts                 # 🆕 Servicio API con auth
    │   │   └── authService.ts         # 🆕 Servicio de autenticación
    │   ├── types/
    │   │   ├── index.ts               # Tipos principales
    │   │   ├── auth.ts                # 🆕 Tipos de autenticación
    │   │   └── model-viewer.d.ts      # 🆕 Tipos de model-viewer
    │   └── styles/
    │       ├── globals.css            # Estilos globales
    │       └── model-viewer.css       # 🆕 Estilos de AR
    └── public/                        # Archivos estáticos
```

## 🔧 Tecnologías Utilizadas

### Backend (.NET 9)

| Tecnología | Versión | Propósito |
|------------|---------|-----------|
| **.NET** | 9.0 | Framework principal |
| **Entity Framework Core** | 8.0.11 | ORM y gestión de BD |
| **MySQL** | 8.0 | Base de datos relacional 🆕 |
| **Pomelo.EntityFrameworkCore.MySql** | 8.0.2 | Proveedor MySQL para EF Core 🆕 |
| **Docker** | - | Contenedor MySQL 🆕 |
| **Minimal APIs** | - | Endpoints REST ligeros |
| **Swagger/OpenAPI** | - | Documentación de API |
| **JWT Authentication** | - | Autenticación segura 🆕 |

### Frontend (Next.js 15)

| Tecnología | Versión | Propósito |
|------------|---------|-----------|
| **Next.js** | 15.0 | Framework React |
| **TypeScript** | 5.0+ | Tipado estático |
| **Tailwind CSS** | 3.4 | Estilos utility-first |
| **React Three Fiber** | 8.18 | Renderizado 3D |
| **@react-three/drei** | 9.122 | Helpers para Three.js |
| **Three.js** | 0.164 | Motor 3D |
| **model-viewer** | 3.4+ | AR web de Google |
| **QRCode** | 1.5 | Generación de QR |
| **Zustand** | 4.5 | State management |
| **Framer Motion** | 11.18 | Animaciones |

## 🚀 Guía de Instalación

### Prerrequisitos

Asegúrate de tener instalado:

- ✅ **Node.js** 20.0 o superior
- ✅ **.NET SDK** 9.0
- ✅ **Docker y Docker Compose** (para MySQL) 🆕
- ✅ **Git** para control de versiones
- ✅ **PowerShell** 7+ (Windows) o Bash (Linux/Mac)

### 1. Clonar el Repositorio

```powershell
git clone https://github.com/JuanPabloTorres/QuickAR.git
cd QuickAR
```

### 2. Iniciar Base de Datos MySQL 🐳

**¡NUEVO!** Ahora usamos MySQL en Docker en lugar de SQLite:

```powershell
# Iniciar contenedor MySQL
docker-compose up -d

# Verificar que MySQL está corriendo
docker ps

# Ver logs si hay problemas
docker-compose logs mysql
```

**Configuración de MySQL:**
- **Puerto:** 3306
- **Base de datos:** quickar_db
- **Usuario:** quickar_user
- **Contraseña:** QuickAR_Pass_2025!

El contenedor tiene:
- ✅ Healthcheck automático
- ✅ Volumen persistente (mysql_data)
- ✅ Red custom (quickar-network)

### 3. Configurar Backend (.NET API)

```powershell
# Navegar a la carpeta del API
cd QrAr.Api

# Restaurar dependencias
dotnet restore

# Aplicar migraciones de base de datos
dotnet ef database update

# Ejecutar el servidor (modo desarrollo)
dotnet run

# O usar watch para auto-reload
dotnet watch run
```

**⚠️ IMPORTANTE:** Asegúrate de que MySQL esté corriendo antes de ejecutar el backend:

```powershell
# Verificar estado de MySQL
docker ps | findstr mysql

# Si no está corriendo, iniciarlo
docker-compose up -d
```

El API estará disponible en:

- 🌐 HTTP: `http://localhost:5001`
- 🔒 HTTPS: `https://localhost:5002`
- 📚 Swagger: `https://localhost:5002/swagger`

### 3. Configurar Frontend (Next.js)

```powershell
# Navegar a la carpeta del frontend
cd qr-ar-admin

# Instalar dependencias
npm install

# Ejecutar en desarrollo
npm run dev

# O para desarrollo con HTTPS
npm run dev:https
```

El frontend estará disponible en:
- 🌐 HTTP: `http://localhost:3001`
- 🔒 HTTPS: `https://localhost:3000` (con dev:https)

### 4. Configuración de Variables de Entorno

#### Backend (`QrAr.Api/appsettings.json`) 🆕

**¡ACTUALIZADO!** Ahora usa MySQL en lugar de SQLite:

```json
{
  "ConnectionStrings": {
    "DefaultConnection": "Server=localhost;Port=3306;Database=quickar_db;User=quickar_user;Password=QuickAR_Pass_2025!;CharSet=utf8mb4;"
  },
  "Jwt": {
    "Key": "tu-clave-secreta-super-segura-de-al-menos-32-caracteres",
    "Issuer": "QuickAR",
    "Audience": "QuickAR-Users",
    "ExpirationMinutes": 60
  },
  "AllowedOrigins": [
    "http://localhost:3001",
    "https://localhost:3001",
    "https://localhost:3000"
  ]
}
```

**Notas importantes:**
- ✅ La cadena de conexión apunta a MySQL en Docker (puerto 3306)
- ✅ JWT Key debe ser una cadena segura de al menos 32 caracteres
- ✅ Los orígenes permitidos incluyen ambos protocolos HTTP/HTTPS

#### Frontend (`qr-ar-admin/.env.local`) 🆕

**¡NUEVO!** Crea este archivo para configuración del frontend:

```env
# URL base del API backend
NEXT_PUBLIC_API_BASE_URL=https://localhost:5002
API_INTERNAL_BASE_URL=https://localhost:5002

# Puerto del frontend (3001 por defecto)
# El frontend corre en https://localhost:3001
```

**Notas importantes:**
- ✅ `NEXT_PUBLIC_API_BASE_URL` se expone al navegador (para llamadas desde cliente)
- ✅ `API_INTERNAL_BASE_URL` se usa en servidor Next.js (SSR)
- ✅ Los tokens JWT se guardan en localStorage con la clave `"auth_token"`
    "https://localhost:3000"
  ]
}
```

#### Frontend (`.env.local`)

```env
# API Backend URL
NEXT_PUBLIC_API_BASE_URL=http://localhost:5001

# Para producción
# NEXT_PUBLIC_API_BASE_URL=https://tu-api.com
```

## 📱 Guía de Uso

### Crear una Experiencia AR

1. **Acceder al Panel Admin**
   - Navega a `http://localhost:3001`
   - Inicia sesión (o regístrate)

2. **Crear Nueva Experiencia**
   - Click en "Nueva Experiencia"
   - Completa el formulario:
     - **Título**: Nombre descriptivo
     - **Slug**: URL amigable (auto-generado)
     - **Descripción**: Descripción opcional

3. **Agregar Assets**
   - Click en "Agregar Asset"
   - Selecciona el tipo:
     - 📦 **Modelo 3D**: Sube archivo `.glb` o `.gltf`
     - 🖼️ **Imagen**: Sube `.jpg`, `.png`, `.webp`
     - 🎥 **Video**: Sube `.mp4`, `.webm`
     - 💬 **Mensaje**: Escribe texto
     - 🌐 **Web Content**: Ingresa URL
   - Completa los campos y guarda

4. **Generar Código QR**
   - El sistema genera automáticamente un QR
   - Descarga o comparte el enlace

5. **Ver en AR**
   - Escanea el QR con tu móvil
   - O accede directamente a la URL
   - El sistema detectará automáticamente tu dispositivo
   - **Móvil**: Verás botón "Ver en AR" para modelos 3D
   - **Desktop**: Verás visualización 3D interactiva

### Probar AR en Diferentes Dispositivos

#### En Android:
1. Abre Chrome en tu Android
2. Escanea el QR o accede a la URL
3. Para modelos 3D, verás el botón "Ver en AR"
4. Click para activar la cámara y ver en tu espacio

#### En iOS:

1. Abre Safari en tu iPhone/iPad
2. Escanea el QR o accede a la URL
3. Para modelos 3D, aparecerá el ícono de AR
4. Tap para usar Quick Look AR nativo

#### En Desktop:

1. Abre cualquier navegador moderno
2. Accede a la URL de la experiencia
3. Usa mouse para interactuar:
   - **Click izquierdo + arrastrar**: Rotar
   - **Scroll**: Zoom
   - **Click derecho + arrastrar**: Desplazar
   - **Click en objeto**: Seleccionar

## 🐳 Comandos Docker Útiles

### Gestión del Contenedor MySQL

```powershell
# Iniciar MySQL
docker-compose up -d

# Ver estado de contenedores
docker ps

# Ver logs en tiempo real
docker-compose logs -f mysql

# Detener MySQL
docker-compose down

# Detener y eliminar volúmenes (⚠️ borra todos los datos)
docker-compose down -v

# Reiniciar contenedor
docker-compose restart mysql
```

### Acceso a MySQL

```powershell
# Conectarse a MySQL desde la terminal
docker exec -it quickar-mysql mysql -u quickar_user -p
# Password: QuickAR_Pass_2025!

# Ejecutar comandos SQL directamente
docker exec quickar-mysql mysql -u quickar_user -pQuickAR_Pass_2025! -e "SHOW DATABASES;"

# Backup de la base de datos
docker exec quickar-mysql mysqldump -u quickar_user -pQuickAR_Pass_2025! quickar_db > backup.sql

# Restaurar backup
docker exec -i quickar-mysql mysql -u quickar_user -pQuickAR_Pass_2025! quickar_db < backup.sql
```

## 🔐 Autenticación y Seguridad

### Flujo de Autenticación JWT

1. **Registro de Usuario**: `POST /api/v1/auth/register`
   - Crea usuario con email y contraseña
   - Contraseña hasheada con BCrypt

2. **Login**: `POST /api/v1/auth/login`
   - Retorna JWT token válido por 60 minutos
   - Token incluye: userId, email, roles

3. **Uso del Token**:
   - Frontend guarda token en `localStorage` con clave `"auth_token"`
   - Incluye en header: `Authorization: Bearer {token}`
   - API valida token en cada request protegido

4. **Protección de Rutas**:
   - Backend: Usa `[Authorize]` attribute
   - Frontend: Usa `ProtectedRoute` component

### Endpoints de Autenticación

```typescript
// Registro
POST /api/v1/auth/register
{
  "email": "usuario@example.com",
  "password": "Password123!",
  "fullName": "Usuario Test"
}

// Login
POST /api/v1/auth/login
{
  "email": "usuario@example.com",
  "password": "Password123!"
}

// Respuesta
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "userId": "550e8400-e29b-41d4-a716-446655440000",
  "email": "usuario@example.com",
  "expiresAt": "2024-01-15T12:00:00Z"
}
```

### Uso en Frontend

```typescript
// authService guarda el token
localStorage.setItem("auth_token", token);

// experiences.ts y api.ts lo leen
const token = localStorage.getItem("auth_token");

// Lo incluyen en headers
headers: {
  'Authorization': `Bearer ${token}`,
  'Content-Type': 'application/json'
}
```

## 🎯 Endpoints de API

### Experiencias

```http
GET    /api/v1/experiences              # Listar todas (requiere auth 🔒)
GET    /api/v1/experiences/{id}         # Obtener por ID
GET    /api/v1/experiences/slug/{slug}  # Obtener por slug
POST   /api/v1/experiences              # Crear nueva (requiere auth 🔒)
PUT    /api/v1/experiences/{id}         # Actualizar (requiere auth 🔒)
DELETE /api/v1/experiences/{id}         # Eliminar (requiere auth 🔒)
PATCH  /api/v1/experiences/{id}/toggle-active  # Activar/Desactivar (requiere auth 🔒)
```

### Assets de Archivo

```http
POST   /api/files/upload                # Subir archivo
GET    /uploads/{filename}              # Descargar archivo
```

### Analytics

```http
POST   /api/analytics/track             # Registrar evento
GET    /api/analytics/experience/{id}   # Estadísticas por experiencia
```

### Autenticación

```http
POST   /api/auth/register               # Registrar usuario
POST   /api/auth/login                  # Iniciar sesión
POST   /api/auth/refresh                # Refrescar token
```

## 🎨 Arquitectura AR Explicada

### Flujo de Detección y Renderizado

```
Usuario accede a /ar/[id]
         ↓
┌────────────────────────┐
│  UnifiedARViewer       │  ← Componente principal
│  - Detecta dispositivo │
│  - Verifica capacidades│
└────────────────────────┘
         ↓
    ¿Móvil o AR disponible?
         ↓
    ┌────┴────┐
    │         │
   SÍ        NO
    │         │
    ↓         ↓
┌─────────┐ ┌──────────────┐
│ Mobile  │ │ Desktop      │
│ AR      │ │ 3D Viewer    │
│ Viewer  │ │              │
└─────────┘ └──────────────┘
    │              │
    ↓              ↓
model-viewer   React Three
WebXR/Scene       Fiber
Viewer/Quick      + drei
Look
```

### Componentes AR Clave

#### 1. **UnifiedARViewer** 🎯
- Punto de entrada principal
- Detecta capacidades del dispositivo
- Rutea al viewer apropiado
- Maneja estados de carga y error

#### 2. **MobileARViewer** 📱
- Usa `<model-viewer>` de Google
- Soporta WebXR, Scene Viewer, Quick Look
- Botón "Ver en AR" prominente
- Renderiza todos los tipos de assets

#### 3. **Desktop3DViewer** 🖥️
- Usa React Three Fiber
- Escena 3D interactiva completa
- Controles de cámara orbital
- Iluminación y sombras realistas

#### 4. **useARCapabilities** 🔍
- Hook personalizado
- Detecta tipo de dispositivo
- Verifica soporte WebXR
- Identifica plataforma (iOS/Android)
- Retorna capacidades disponibles

## 🧪 Testing y QA

### Checklist de Pruebas

#### Desktop
- [ ] Visualización 3D funciona en Chrome
- [ ] Visualización 3D funciona en Firefox
- [ ] Visualización 3D funciona en Safari
- [ ] Controles de cámara responsive
- [ ] Assets se cargan correctamente
- [ ] Navegación entre assets fluida

#### Android
- [ ] Chrome: WebXR funciona
- [ ] Chrome: Scene Viewer funciona
- [ ] Firefox: Visualización funciona
- [ ] Botón AR visible y funcional
- [ ] Cámara se activa correctamente

#### iOS
- [ ] Safari: Quick Look funciona
- [ ] Chrome: Visualización funciona
- [ ] Botón AR visible
- [ ] Assets se descargan correctamente

### Comandos de Testing

```powershell
# Frontend - Type checking
cd qr-ar-admin
npm run type-check

# Frontend - Linting
npm run lint

# Backend - Unit tests
cd QrAr.Api
dotnet test

# Backend - Build
dotnet build
```

## 📈 Roadmap

### Versión 1.1 (Q4 2025)
- [ ] Editor AR en tiempo real
- [ ] Plantillas de experiencias predefinidas
- [ ] Exportación de experiencias
- [ ] Colaboración multi-usuario

### Versión 1.2 (Q1 2026)
- [ ] Marketplace de assets 3D
- [ ] Animaciones en modelos 3D
- [ ] Audio espacial
- [ ] Geolocalización AR

### Versión 2.0 (Q2 2026)
- [ ] AR Cloud (persistencia)
- [ ] Multiplayer AR
- [ ] IA generativa de assets
- [ ] WebGPU para mejor rendimiento

## 🐛 Solución de Problemas

### Error: "Unable to connect to any of the specified MySQL hosts" 🆕

**Causa**: MySQL no está corriendo o no está accesible
**Solución**:

```powershell
# 1. Verificar que Docker está corriendo
docker ps

# 2. Si no aparece quickar-mysql, iniciarlo
docker-compose up -d

# 3. Verificar logs de MySQL
docker-compose logs mysql

# 4. Verificar healthcheck
docker inspect quickar-mysql | findstr "Health"

# 5. Reiniciar contenedor si es necesario
docker-compose restart mysql
```

### Error: "Authentication to host 'localhost' failed" 🆕

**Causa**: Credenciales incorrectas en connection string
**Solución**:

- Verifica que `appsettings.json` tiene las credenciales correctas:
  - User: `quickar_user`
  - Password: `QuickAR_Pass_2025!`
  - Database: `quickar_db`
  - Port: `3306`

```json
"DefaultConnection": "Server=localhost;Port=3306;Database=quickar_db;User=quickar_user;Password=QuickAR_Pass_2025!;CharSet=utf8mb4;"
```

### Error: "401 Unauthorized" en llamadas a API 🆕

**Causa**: Token JWT no se está enviando correctamente
**Solución**:

```typescript
// 1. Verificar que el token se guardó en localStorage
console.log(localStorage.getItem("auth_token"));

// 2. Verificar que se incluye en headers (experiences.ts y api.ts)
const token = localStorage.getItem("auth_token");
headers: {
  'Authorization': `Bearer ${token}`,
  'Content-Type': 'application/json'
}

// 3. Verificar que el token no expiró
// Los tokens JWT expiran después de 60 minutos por defecto
// Si expiró, hacer login nuevamente
```

### Error: "Cannot find module '@google/model-viewer'"

**Causa**: Dependencias de frontend no instaladas
**Solución**:

```powershell
cd qr-ar-admin
npm install
# O si persiste:
rm -rf node_modules package-lock.json
npm install
```

### Error: "Port 3306 already in use" 🆕

**Causa**: Otro servicio MySQL ya está usando el puerto 3306
**Solución**:

```powershell
# Opción 1: Detener otro MySQL
# En Windows:
Stop-Service MySQL80  # O el nombre de tu servicio

# Opción 2: Cambiar puerto en docker-compose.yml
# Editar docker-compose.yml:
ports:
  - "3307:3306"  # Usa 3307 en lugar de 3306

# Y actualizar appsettings.json:
"Server=localhost;Port=3307;Database=quickar_db;..."
```

### Error: "AR no disponible"

**Causa**: Dispositivo no soporta AR o conexión no segura
**Solución**:

- Verifica que estás usando HTTPS o localhost
- Asegúrate que el dispositivo soporta WebXR
- En Android, actualiza Chrome a última versión
- En iOS, usa Safari (no Chrome)

### Error: "Modelo 3D no carga"
**Causa**: Archivo corrupto, formato no soportado, o problema de CORS
**Solución**:
- Verifica que el archivo es `.glb` o `.gltf` válido
- Confirma que el archivo no excede 50MB
- Revisa la consola del navegador para errores CORS
- Asegúrate que el backend está corriendo

### Error: "No se puede subir archivo"
**Causa**: Archivo muy grande o tipo no permitido
**Solución**:
- Máximo 50MB por archivo
- Solo se permiten: `.glb`, `.gltf`, `.jpg`, `.png`, `.webp`, `.mp4`, `.webm`
- Verifica permisos de escritura en `wwwroot/uploads/`

### Performance: "Modelo 3D lento"
**Causa**: Modelo muy complejo o dispositivo limitado
**Solución**:
- Optimiza el modelo (reduce polígonos)
- Usa texturas comprimidas
- Considera usar LOD (Level of Detail)
- Limita a ~100K triángulos para móviles

## 🔒 Seguridad

### Autenticación
- JWT (JSON Web Tokens) con expiración
- Refresh tokens para sesiones largas
- Passwords hasheados con bcrypt
- Protección CSRF en formularios

### CORS
- Configurado solo para orígenes permitidos
- Headers de seguridad apropiados
- Rate limiting en endpoints sensibles

### File Upload
- Validación de tipo MIME
- Límite de tamaño de archivo
- Nombres de archivo sanitizados
- Almacenamiento seguro fuera del webroot público

## 📚 Documentación Adicional

### Estructura de Datos

#### Experience
```typescript
interface Experience {
  id: string;              // GUID único
  title: string;           // Título de la experiencia
  slug: string;            // URL-friendly identifier
  description?: string;    // Descripción opcional
  isActive: boolean;       // Estado activo/inactivo
  assets: Asset[];         // Assets asociados
  createdAt: Date;         // Fecha de creación
  updatedAt: Date;         // Última actualización
  userId?: string;         // Propietario
}
```

#### Asset
```typescript
interface Asset {
  id: string;              // GUID único
  name: string;            // Nombre del asset
  assetType: AssetType;    // Tipo de asset
  assetUrl?: string;       // URL del archivo
  mimeType?: string;       // Tipo MIME
  fileSizeBytes?: number;  // Tamaño en bytes
  assetContent?: string;   // Contenido (para messages)
}

type AssetType = 
  | "model3d"     // Modelos 3D (.glb, .gltf)
  | "image"       // Imágenes (.jpg, .png, .webp)
  | "video"       // Videos (.mp4, .webm)
  | "message"     // Texto plano
  | "webcontent"; // URLs externas
```

### Comandos Útiles

#### Backend

```powershell
# Crear nueva migración
dotnet ef migrations add NombreMigracion

# Aplicar migraciones
dotnet ef database update

# Revertir migración
dotnet ef database update MigracionAnterior

# Eliminar última migración
dotnet ef migrations remove

# Ver migraciones aplicadas
dotnet ef migrations list

# Crear build de producción
dotnet publish -c Release -o ./publish

# Limpiar build
dotnet clean
```

#### Frontend

```powershell
# Desarrollo
npm run dev          # Puerto 3001 HTTP
npm run dev:https    # Puerto 3000 HTTPS
npm run dev:mobile   # 0.0.0.0:3000 (acceso red local)

# Build
npm run build        # Crear build de producción
npm run start        # Ejecutar build de producción

# Calidad de código
npm run lint         # ESLint
npm run type-check   # TypeScript checking

# Limpieza
rm -rf .next         # Eliminar build
rm -rf node_modules  # Eliminar dependencias
npm install          # Reinstalar dependencias
```

## 🤝 Contribuir

¡Las contribuciones son bienvenidas! Por favor sigue estos pasos:

### 1. Fork y Clone
```bash
# Fork el repositorio en GitHub
git clone https://github.com/tu-usuario/QuickAR.git
cd QuickAR
```

### 2. Crear Rama
```bash
# Crear rama para tu feature
git checkout -b feature/mi-nueva-caracteristica

# O para un bugfix
git checkout -b fix/arreglar-bug
```

### 3. Desarrollar
- Sigue las convenciones de código existentes
- Escribe código TypeScript tipado
- Agrega comentarios JSDoc donde sea necesario
- Prueba en múltiples navegadores/dispositivos

### 4. Commit
```bash
# Commits descriptivos siguiendo conventional commits
git commit -m "feat: agregar nueva característica X"
git commit -m "fix: corregir bug en componente Y"
git commit -m "docs: actualizar README"
```

### 5. Push y Pull Request
```bash
# Push a tu fork
git push origin feature/mi-nueva-caracteristica

# Crear Pull Request en GitHub
# Describe los cambios claramente
# Incluye capturas de pantalla si aplica
```

### Guías de Estilo

#### TypeScript
- Usa `interface` para objetos, `type` para uniones
- Nombra interfaces con prefijo `I` solo si es necesario
- Prefiere `const` sobre `let`, evita `var`
- Usa arrow functions para callbacks

#### React
- Componentes funcionales con hooks
- Props destructuring en la firma
- `memo()` para componentes pesados
- Custom hooks con prefijo `use`

#### CSS
- Usa Tailwind classes cuando sea posible
- Evita estilos inline
- Agrupa clases relacionadas
- Usa variables CSS para temas

## 📜 Licencia

Este proyecto está licenciado bajo la **MIT License**.

```
MIT License

Copyright (c) 2025 QuickAR

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
```

## 📞 Contacto y Soporte

### Reportar Problemas
- 🐛 **Bugs**: [Abrir Issue en GitHub](https://github.com/JuanPabloTorres/QuickAR/issues/new?template=bug_report.md)
- 💡 **Feature Request**: [Sugerir Feature](https://github.com/JuanPabloTorres/QuickAR/issues/new?template=feature_request.md)
- 📖 **Documentación**: [Mejorar Docs](https://github.com/JuanPabloTorres/QuickAR/issues/new?template=documentation.md)

### Comunidad
- 💬 **Discussions**: [GitHub Discussions](https://github.com/JuanPabloTorres/QuickAR/discussions)
- 📧 **Email**: support@quickar.dev
- 🐦 **Twitter**: [@QuickARDev](https://twitter.com/QuickARDev)

## 🙏 Agradecimientos

Este proyecto fue posible gracias a:

- **[Google Model Viewer](https://modelviewer.dev/)** - Por la increíble librería AR
- **[React Three Fiber](https://docs.pmnd.rs/react-three-fiber)** - Por el wrapper de Three.js
- **[drei](https://github.com/pmndrs/drei)** - Por los helpers de Three.js
- **[Next.js Team](https://nextjs.org/)** - Por el mejor framework de React
- **[.NET Team](https://dotnet.microsoft.com/)** - Por la plataforma robusta
- **Comunidad Open Source** - Por las contribuciones y feedback

## 🌟 Showcase

¿Creaste algo genial con QuickAR? ¡Compártelo!

Envía un PR agregando tu proyecto aquí o menciona [@QuickARDev](https://twitter.com/QuickARDev) en Twitter.

### Ejemplos de Uso
- 🏛️ **Museos**: Tours virtuales AR
- 🏢 **Real Estate**: Visualización de propiedades
- 🎓 **Educación**: Modelos anatómicos 3D
- 🛍️ **E-commerce**: Preview de productos
- 🎨 **Arte**: Galerías virtuales
- 🏭 **Industria**: Manuales de mantenimiento

---

<div align="center">

**Hecho con ❤️ por el equipo de QuickAR**

⭐ Si te gusta este proyecto, ¡dale una estrella en GitHub! ⭐

[⬆ Volver arriba](#quickar---plataforma-de-realidad-aumentada-)

</div>
